---
title: "複雑化する資源評価業務との付き合い方"
author: "木下順二・真鍋明弘・市野川桃子（水産機構資源研）"
date: "Nov. 20, 2021"
output:
    slidy_presentation:
        theme: sandstone
        font_adjustment: +2
        incremental: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#     powerpoint_presentation:
#         reference_doc: ref.potx
```


# __背景と着眼__
__現状__ 改正漁業法の下で資源評価対象魚種が拡大する一方、人的リソースは限られる。  
<br></br><br></br>
__変化__ このような状況下で、資源評価の透明性・再現性・客観性の要求は高まっており、  
　　 担当者の負担はますます大きくなっている。  
<br></br><br></br>
__問い__ この状況に適応するためには働き方（考え方）を変化させていく必要があるのではないか。  
<br></br><br></br>
そこで、

# __現状の資源評価業務の"例"__
資源評価業務は __データ整理から始まり、数値計算、ドキュメント作成までの流れ作業__ であり、  
主担当者は全ての工程を多能工的にこなしている。その上で、  

1. 大量の情報・ファイルの管理と、`.docx`へのドキュメント化の際に  
   それらの検索・選択・取得を、マウス操作などの手作業で行う必要がある  
    * 検索の手間と選び取りミスの危険がある（この作業は他者からは見えない）。  
    * 多量の単純作業——数値や図表のコピーアンドペーストなど——が存在する。  
  
2. 複数のシナリオを検討する必要がある  
    * シナリオ数（試行錯誤回数）が増えるほどファイル管理のコストと単純作業も増す。  
  
3. ドキュメント（ドラフト）を生成して初めて他人からのフィードバックがある  
    * スペルミスなどへの細かな指摘から  
      数値の転記ミスなど注意を要する重要な指摘、  
      さらに、どのシナリオを選ぶかなどの大きな指摘までがこの段階でなされる。  
    * 単純作業に労力を取られて、本質的な問題にたどり着くまでに時間がかかる可能性がある。  

# __状況改善の"案"__
__作業の最終工程であるドキュメント作成を流れの起点にする__ という逆転の発想の下で、  
可能な限りヒューマンエラー（ムダ）を減らす方法をソフトウェア開発手法から学ぶ。  

`r emo::ji("point_right")`（ドキュメントに）必要な情報のみを必要な時に取り込む「ジャスト・イン・タイム」の考え方  

1. ドキュメントに情報へのリンク（パス）を書き込み、  
   図表や数値が自動引用・更新される仕組みを使う  
    `r emo::ji("wrench")`ツール例: __R, Rmarkdown__
    `r knitr::include_graphics(R.home("doc/html/logo.jpg"))`  

    * パスを書き込むことで、どの情報を選び取ったかが明確になる（透明性の確保） 

    * データの転記ミス等が減る（再現性の向上） 

    * 一度パスを構築してしまえば、次回からはコピペなどの単純作業を行わなくて済む（省力化） 

`r emo::ji("scorpion")` RとRmarkdownのコーディング技術の習得が必要  

# __状況改善の"案"__
2. 多数のシナリオを管理しやすい仕組みを使う  
    `r emo::ji("wrench")`ツール例: __Git__（バージョン管理システム） 

    * 更新履歴の管理に止まらず、多数のシナリオを並列開発することを念頭に作られたツール  

    * 

`r emo::ji("scorpion")` このツールの仕組みの理解および取扱技術の習得が必要  

# __状況改善の"案"__
3. フィードバックを得やすい仕組みを使う  
    `r emo::ji("wrench")`ツール例: __GitHub、Amazon S3__（クラウドサービス） 

    * 例えば、数値が異常に大きいなどの経験知をテストプログラムとして組み込み、  
      それが検知されたときはシステムが停止する（バグの発見）  
      `r emo::ji("point_right")` システムに人間の知恵を付加するという「自働化」の考え方  

        * こうした経験知は暗黙知である場合も多いため、  
          テストプログラムとして明文しておくことで透明性の確保にもつながる  

    * クラウドサービス上で最新のドキュメントが閲覧できる  
      = プログラムが全てのテストを無事通過した  
      `r emo::ji("point_right")` テストが充実していればドキュメントの信頼性が向上する  

    * また、クラウドサービス上で最新のドキュメントが閲覧できるので  
      他者がレビューしやすい（フィードバックを得やすい）  

`r emo::ji("scorpion")` ソフトウェア（パッケージ）として開発する必要  
`r emo::ji("scorpion")` クラウドサービスの取扱技術の習得  
`r emo::ji("scorpion")` レビュワーもクラウドサービスを扱える必要  

# __CIドキュメントシステムの手順例__
1. Excelファイルに各種データを整理する: Excelファイルをデータベースとする  
2. `R`にExcelファイルのデータを読み込む  
3. `R`および`Rmarkdown`で数値計算とフォーマットを指定してドキュメントを作成する  
4. 作成したドキュメントをクラウドサービス（GitHub）にアップロードする  
5. クラウドサービス上でドキュメントが指定したフォーマットに自動的にレンダリングされる（PDFやWordなど）
6. 生成されたドキュメントが自動的に（関係者に）公開される  
7. レビューを受ける  
8. ドキュメントを改訂する  

以下、繰り返し。

# 結果はどうなる | __ドキュメント生成の自動化__  
1. 再現性の担保  
    * 使用したデータ、解析方法、異常数値の知見の可視化により再現性が頑健になる  
2. ドキュメントの更新性  
    * 新しいデータや計算方法が追加されると、ドキュメントも最新の情報で精製される  
    * 常に新しいバージョンを閲覧可能  
    * ドキュメントのバージョン管理により、議論のしやすさが向上  

# 結果はどうなる | __仕事の見える化__  
1. 意思決定や問題解決の内容が可視化される  
    * 誰がどのような仕事をしたか  
    * 誰が何を決めたか  
    * 議論の内容の文字化  

# 結果はどうなる | __仕事の省力化__  
1. `R`パッケージとして開発されていれば、他の担当者の有用なコードを導入しやすい。  

# __課題・留意点__
1. 新しいツールの学習コスト  
2. 多魚種に共通のパッケージを作るには大規模で相当な労力が必要  
3.  

* ドキュメントに必要な情報が明確でないと、この手法は却って混乱を生み出す。  

* ソフトウェア開発手法の適用ではあるが、全てのソフトウェア開発会社がこの方法を採用しているわけではない。  
  実際にうまくいっている例もあるだろうが、開発と運用に関わる全ての人がこの方法を理解し、  
  継続的な改善に協力的でないと破綻する。改善には10年以上かかる例もざらであるようだ。  

*  

* Microsoft Office系のソフト（WordやExcel等）でもいわゆるマクロやクエリを使えば  
  できるのかもしれない。つまりは、本気度に由来する。  

# __リーン生産方式__
1. 作業手順の改善を探求し続ける  
    * ムダの認識と撲滅  
    * ムダ（問題点）を発見するために５回の「なぜ」を常に自らに問う  
    * ムダの分類（例）  
        1. コピペなどの単純作業の増加
        2. （単純作業の）未完の作業
        3. 遅れや待ち  
        4. 欠陥  
        5. タスクの切り替えにかかる時間  
        6. 余分な機能  
        7. 不要な引継ぎ  
2. 手順改善では対応できない部分を設備改善（使う道具）で補う  
    * 新しい道具に習熟しようとする気概を持つ  
3. 働き方を変えるには長い時間と多くの労力が必要であることを認める  

# __まとめ__
(仮置き）CIドキュメントシステムによって、  

* 数値や図表の転載ミスを防ぎ、再現性のあるドキュメント生成が可能  
* Rパッケージ形式で作業することで、作業ミスがあった場合にコンピュータが  
  知らせてくれるため、間違いにすぐに気づけるようになる。  
* 他の人が解決した方法をすぐに取り入れられるので、我が国資源評価全体としての  
  重複作業を軽減できる。  

